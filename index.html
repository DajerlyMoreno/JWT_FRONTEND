<!DOCTYPE html>
<html lang="es" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JWT Analyzer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="script.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="animated-bg"></div>
  <div class="grid-pattern"></div>

  <div class="main-container">
    <!-- HEADER -->
    <header class="header">
      <h1 class="logo">JWT ANALYZER</h1>
      <p class="subtitle">Decode ‚Ä¢ Encode ‚Ä¢ Analyze ‚Ä¢ Verify</p>
    </header>

    <!-- TABS NAVEGACI√ìN -->
    <nav class="tabs-container">
      <button class="tab-btn active" onclick="showTab('decoder', event)">
        <i data-lucide="unlock" class="w-5 h-5"></i>
        <span>Decoder</span>
      </button>
      <button class="tab-btn" onclick="showTab('encoder', event)">
        <i data-lucide="lock" class="w-5 h-5"></i>
        <span>Encoder</span>
      </button>
      <button class="tab-btn" onclick="showTab('analysis', event)">
        <i data-lucide="microscope" class="w-5 h-5"></i>
        <span>Analysis</span>
      </button>
      <button class="tab-btn" onclick="showTab('history', event)">
        <i data-lucide="clock" class="w-5 h-5"></i>
        <span>History</span>
        <span id="historyBadge" class="tab-badge">0</span>
      </button>
    </nav>

    <!-- CONTENIDO -->
    <div style="padding: 0 1rem 4rem;">
      
      <!-- DECODER -->
      <section id="decoder" class="section active">
        <div class="card">
          <h2 class="card-title">
            <i data-lucide="unlock" class="w-8 h-8"></i>
            Token Decoder
          </h2>
          <p class="card-description">Paste your JWT token below to decode and analyze its contents</p>
          
          <div class="input-group">
            <label class="input-label">JWT Token</label>
            <textarea id="tokenInput" class="textarea-field" placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."></textarea>
          </div>

          <button class="btn-primary" onclick="decodeToken()">
            <i data-lucide="zap" class="w-5 h-5"></i>
            <span>Decode Token</span>
          </button>

          <div class="result-title">
            <i data-lucide="terminal" class="w-4 h-4"></i>
            Decoded Results
          </div>

          <div id="decodeResult" class="decode-grid">
            <div class="empty-decode">
              <i data-lucide="key" class="empty-icon"></i>
              <p>Waiting for token...</p>
            </div>
          </div>

          <button id="viewAnalysisBtn" class="btn-secondary hidden" onclick="goToAnalysis()">
            <i data-lucide="microscope" class="w-5 h-5"></i>
            <span>View Complete Analysis</span>
          </button>

              <!-- JWT SIGNATURE VERIFICATION (OPCIONAL) -->
          <div class="card" style="margin-top: 1.5rem;">
            <h3 class="card-title" style="margin-bottom: 0.5rem;">
              <i data-lucide="shield-check" class="w-6 h-6"></i>
              JWT Signature Verification (optional)
            </h3>
            <p class="card-description" style="margin-bottom: 1rem;">
              Enter the secret used to sign this JWT. The token is the last one decoded en este m√≥dulo.
            </p>

            <div class="input-group">
              <label class="input-label">Secret</label>
             <textarea
                id="decoderSecretInput"
                class="textarea-field small-textarea"
                placeholder="a-string-secret-at-least-256-bits-long"
              ></textarea>

            </div>

            <button class="btn-primary" onclick="verifySignatureFromDecoder()">
              <i data-lucide="check-circle" class="w-5 h-5"></i>
              <span>Verify Signature</span>
            </button>

            <div id="decoderSignatureResult" class="result-box" style="margin-top: 1rem;">
              Waiting for secret...
            </div>
          </div>



        </div>
      </section>

      <!-- ENCODER -->
      <section id="encoder" class="section">
        <div class="card">
          <h2 class="card-title">
            <i data-lucide="lock" class="w-8 h-8"></i>
            Token Encoder
          </h2>
          <p class="card-description">Create a new JWT token with custom header, payload and secret</p>
          
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
            <div class="input-group">
              <label class="input-label">Header</label>

              <textarea
                id="headerInput"
                class="textarea-field"
                placeholder='{"alg": "HS256", "typ": "JWT"}'
                oninput="onHeaderChanged()"
              >
              {
                  "alg": "HS256", 
                  "typ": "JWT"
              }
              </textarea>

            </div>

            <div class="input-group">
              <label class="input-label">Payload</label>
              <textarea id="payloadInput" class="textarea-field" placeholder='{"sub": "user123", "name": "John Doe", "role": "admin"}'>
{
    "sub": "1007142936",
    "name": "Jazmin",
    "admin": false,
    "iat": 1516239022,
    "exp": 250000
}
              </textarea>
            </div>
          </div>

          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
            <div class="input-group">
              <label class="input-label">Secret Key</label>
              <input id="secretInput" type="password" class="input-field" placeholder="your-256-bit-secret">
            </div>

            <div class="input-group">
              <label class="input-label">Algorithm</label>
              <select
                id="algorithmInput"
                class="select-field"
                onchange="onAlgorithmChange()"
              >
                <option value="HS256">HS256</option>
                <option value="HS384">HS384</option>
                <option value="HS512">HS512</option>
              </select>

            </div>
          </div>

          <button class="btn-primary" onclick="encodeToken()">
            <i data-lucide="shield-check" class="w-5 h-5"></i>
            <span>Generate Token</span>
          </button>

          <div class="result-title">
            <i data-lucide="terminal" class="w-4 h-4"></i>
            Generated Token
          </div>
          <pre id="encodeResult" class="result-box">Waiting for generation...</pre>
          <button id="copyTokenBtn" class="btn-secondary hidden" onclick="copyToken()">
            <i data-lucide="copy" class="w-5 h-5"></i>
            <span>Copy Token</span>
          </button>
        </div>
      </section>

      <!-- ANALYSIS -->
      <section id="analysis" class="section">
        <div class="card">
          <h2 class="card-title">
            <i data-lucide="microscope" class="w-8 h-8"></i>
            Advanced Token Analysis
          </h2>
          <p class="card-description">Perform comprehensive lexical, syntactic, semantic and pumping lemma analysis</p>
          
          <div class="input-group">
            <label class="input-label">JWT Token to Analyze</label>
            <textarea id="analysisTokenInput" class="textarea-field" placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."></textarea>
          </div>

          <button class="btn-primary" onclick="performAnalysis()">
            <i data-lucide="scan" class="w-5 h-5"></i>
            <span>Run Complete Analysis</span>
          </button>

          <!-- An√°lisis L√©xico -->
          <div class="analysis-section">
            <div class="result-title">
              <i data-lucide="list" class="w-4 h-4"></i>
              Lexical Analysis
            </div>
          
            <div id="lexicalResult" class="lexical-container">
              Waiting for analysis...
            </div>
          </div>
               

          <!-- An√°lisis Sint√°ctico -->
          <div class="analysis-section">
            <div class="result-title">
              <i data-lucide="braces" class="w-4 h-4"></i>
              Syntactic Analysis
            </div>

            <!-- üëá ESTE es el contenedor que tu JS necesita -->
            <div id="syntacticResult" class="result-box">
              Waiting for analysis...
            </div>
          </div>


          <!-- An√°lisis Sem√°ntico -->
          <div class="analysis-section">
            <div class="result-title">
              <i data-lucide="brain" class="w-4 h-4"></i>
              Semantic Analysis
            </div>
            <div id="semanticResult" class="semantic-container">
              Waiting for analysis...
            </div>
          </div>
        </section>
      <!-- HISTORY onclick="clearHistory()"  -->
      <section id="history" class="section">
        <div class="card">
          <div class="history-header">
            <div>
              <h2 class="card-title" style="margin-bottom: 0.5rem;">
                <i data-lucide="clock" class="w-8 h-8"></i>
                Operation History
              </h2>
              <p class="card-description" style="margin-bottom: 0;">Track all your JWT operations</p>
            </div>
            
            <button class="btn-danger" >
              <i data-lucide="trash-2" class="w-4 h-4"></i>
              <span>Clear All</span>
            </button>
          </div>
          
          <div id="historyList" class="history-list">
            <div class="empty-state">
              <i data-lucide="inbox" class="empty-state-icon"></i>
              <p style="font-size: 1.1rem; margin-bottom: 0.5rem;">No operations yet</p>
              <p style="font-size: 0.9rem;">Start by decoding or encoding a JWT token</p>
            </div>
          </div>
        </div>
      </section>

    </div>
  </div>
</body>
</html>